Turbo Assembler	 Version 4.1	    02/23/20 19:53:34	    Page 1
catcher.asm



      1
      2				     locals @@
      3
      4				     .186
      5	0000			     .model tiny
      6
      7	0000			     .code
      8
      9				     extrn   DrawWindow: proc
     10				     extrn   CodeEnd
     11
     12				     org 100h
     13	0100  33 C0		     Start:	     xor ax, ax
     14	0102  8E C0				     mov es, ax			     ; es -> 0
     15
     16	0104  BB 0024				     mov bx, 9 * 4		     ; int09H in ISR table
     17
     18	0107  FA				     cli
     19	0108  26: 8B 07				     mov ax, word ptr es:[bx]
     20	010B  A3 017Fr				     mov Old09int, ax
     21	010E  26: 8B 47	02			     mov ax, word ptr es:[bx+2]
     22	0112  A3 0181r				     mov Old09int+2, ax
     23
     24	0115  26: C7 07	0137r			     mov word ptr es:[bx], offset Catch09int
     25	011A  26: 8C 4F	02			     mov word ptr es:[bx+2], cs
     26	011E  FB				     sti
     27
     28	011F  B8 3100				     mov ax, 3100h		     ; int21H -	31 (resident)
     29	0122  BA 0000e				     mov dx, offset CodeEnd
     30	0125  C1 EA 04				     shr dx, 4
     31	0128  42				     inc dx
     32	0129  CD 21				     int 21h			     ; Staying resident
     33
     34				     ;==========================================================================
     35				     ; Converts	al 0-3 bits to 1-9A-F hex format
     36				     ; Entry: AL
     37				     ; Exit:  AL <- correct ascii code
     38				     ;==========================================================================
     39
     40	012B			     toHex	     proc
     41
     42	012B  3C 0A				     cmp al, 0ah
     43	012D  72 05				     jb	@@digit
     44
     45	012F  04 37		     @@letter:	     add al, 55d
     46	0131  EB 03 90				     jmp @@exit
     47
     48	0134  04 30		     @@digit:	     add al, 48d
     49
     50	0136  C3		     @@exit:	     ret
     51	0137					     endp
     52
     53				     ;==========================================================================
     54
     55	0137			     Catch09int	     proc
     56
     57	0137  50 53 51 52 57 06			     push ax bx	cx dx di es
Turbo Assembler	 Version 4.1	    02/23/20 19:53:34	    Page 2
catcher.asm



     58
     59	013D  B8 B800				     mov ax, 0b800h
     60	0140  8E C0				     mov es, ax
     61
     62	0142  E4 60				     in	al, 60h
     63
     64	0144  B9 000F				     mov cx, 15d
     65	0147  BA 0005				     mov dx, 5d
     66	014A  BF 01A4				     mov di, (80 * 2 + 50) * 2
     67	014D  E8 0000e				     call DrawWindow
     68
     69	0150  8A D8				     mov bl, al
     70	0152  C0 E8 04				     shr al, 4
     71	0155  24 0F				     and al, 0fh
     72	0157  E8 FFD1				     call toHex
     73
     74	015A  BF 02F2				     mov di, (80 * 4 + 57) * 2
     75	015D  B4 4E				     mov ah, 4eh
     76	015F  AB				     stosw
     77
     78	0160  8A C3				     mov al, bl
     79	0162  24 0F				     and al, 0fh
     80	0164  E8 FFC4				     call toHex
     81	0167  AB				     stosw
     82
     83	0168  E4 61				     in	al, 61h
     84	016A  8A E0				     mov ah, al
     85	016C  0C 80				     or	al, 80h
     86	016E  E6 61				     out 61h, al
     87	0170  8A C4				     mov al, ah
     88	0172  E6 61				     out 61h, al
     89
     90	0174  B0 20				     mov al, 20h
     91	0176  E6 20				     out 20h, al
     92
     93	0178  07 5F 5A 59 5B 58			     pop es di dx cx bx	ax
     94
     95	017E  EA				     db	0eah
     96	017F  0000		     Old09int	     dw	0h
     97	0181  0000				     dw	0h
     98
     99	0183					     endp
    100
    101				     ;==========================================================================
    102
    103				     end	     Start
Turbo Assembler	 Version 4.1	    02/23/20 19:53:34	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/23/20"
??FILENAME			  Text	 "catcher "
??TIME				  Text	 "19:53:34"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@DIGIT				  Near	 DGROUP:0134
@@EXIT				  Near	 DGROUP:0136
@@LETTER			  Near	 DGROUP:012F
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 CATCHER
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
CATCH09INT			  Near	 DGROUP:0137
CODEEND				  Word	 DGROUP:---- Extern
DRAWWINDOW			  Near	 DGROUP:---- Extern
OLD09INT			  Word	 DGROUP:017F
START				  Near	 DGROUP:0100
TOHEX				  Near	 DGROUP:012B

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0183 Word	  Public  CODE
