Turbo Assembler	 Version 4.1	    03/03/20 16:10:41	    Page 1
logger.asm



      1
      2				     locals @@
      3
      4				     .186
      5	0000			     .model tiny
      6
      7	0000			     .code
      8
      9				     public  Logger
     10
     11				     extrn DrawWindow: proc
     12
     13				     extrn   OldIntAddr
     14				     extrn   AsciiBuffer
     15				     extrn   BufEnd
     16
     17				     ;==========================================================================
     18				     ; Key logger on 9th interrupt
     19				     ;==========================================================================
     20
     21	0000			     Logger	     proc
     22
     23	0000  50 53 51 52 57 06	1E		     push    ax	bx cx dx di es ds
     24
     25	0007  9C				     pushf
     26	0008  2E: FF 1E	0012e			     call    dword ptr cs:OldIntAddr + 9 * 2
     27
     28	000D  B4 11				     mov     ah, 11h
     29	000F  CD 16				     int     16h
     30	0011  74 2D				     jz	     @@exit
     31
     32	0013  2E: 8B 1E	0000e			     mov     bx, cs:BufEnd
     33	0018  2E: 88 87	0000e			     mov     byte ptr cs:AsciiBuffer[bx], al
     34	001D  43				     inc     bx
     35	001E  2E: 89 1E	0000e			     mov     cs:BufEnd,	bx
     36
     37	0023  3C 66				     cmp     al, 'f'
     38	0025  75 19				     jne     @@exit
     39
     40	0027  BF 02D0				     mov     di, (80 * 4 + 40) * 2
     41	002A  B9 000A				     mov     cx, 10
     42	002D  BA 0005				     mov     dx, 5
     43
     44	0030  E8 0000e				     call    DrawWindow
     45
     46	0033  BF 0416				     mov     di, (80 * 6 + 43) * 2
     47	0036  B9 0003				     mov     cx, 3d
     48	0039  BE 0048r				     mov     si, offset	Message
     49	003C  0E				     push    cs
     50	003D  1F				     pop     ds
     51
     52	003E  F3> A5				     rep     movsw
     53
     54	0040  1F 07 5F 5A 59 5B	58   @@exit:	     pop     ds	es di dx cx bx ax
     55
     56	0047  CF				     iret
     57	0048					     endp
Turbo Assembler	 Version 4.1	    03/03/20 16:10:41	    Page 2
logger.asm



     58
     59				     ; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     60
     61	0048  48 5F 65 5F 79 5F	     Message	     db	"H_e_y_"
     62
     63				     ;==========================================================================
     64
     65				     end
Turbo Assembler	 Version 4.1	    03/03/20 16:10:41	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/03/20"
??FILENAME			  Text	 "logger  "
??TIME				  Text	 "16:10:41"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@EXIT				  Near	 DGROUP:0040
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0103H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 LOGGER
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ASCIIBUFFER			  Word	 DGROUP:---- Extern
BUFEND				  Word	 DGROUP:---- Extern
DRAWWINDOW			  Near	 DGROUP:---- Extern
LOGGER				  Near	 DGROUP:0000
MESSAGE				  Byte	 DGROUP:0048
OLDINTADDR			  Word	 DGROUP:---- Extern

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  004E Word	  Public  CODE
