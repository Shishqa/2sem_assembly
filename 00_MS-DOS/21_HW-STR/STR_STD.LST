Turbo Assembler	 Version 4.1	    03/03/20 17:51:58	    Page 1
str_std.asm



      1				     locals @@
      2
      3	0000			     .model tiny
      4	0000			     .code
      5
      6				     extrn   memchr: proc
      7				     extrn   memcmp: proc
      8				     extrn   memset: proc
      9				     extrn   memcpy: proc
     10
     11				     public  strlen
     12				     public  strchr
     13				     public  strcpy
     14				     public  strcmp
     15
     16				     ;==========================================================================
     17				     ; Gets length of null-terminated string
     18				     ; Entry: ES:DI - absolute address of string
     19				     ; Exit:  CX <- length of string
     20				     ; Destr: AL DI
     21				     ;==========================================================================
     22
     23	0000			     strlen	     proc
     24
     25	0000  B0 00				     mov al, 0d
     26	0002  B9 FFFF				     mov cx, 0ffffh
     27	0005  E8 0000e				     call memchr
     28
     29	0008  8B F9				     mov di, cx
     30	000A  B9 FFFF				     mov cx, 0ffffh
     31	000D  2B CF				     sub cx, di
     32	000F  49				     dec cx
     33
     34	0010  C3				     ret
     35	0011					     endp
     36
     37				     ;==========================================================================
     38				     ; Looks within bytes of null-terminated string for	the first occurence
     39				     ; of value
     40				     ; Entry: AL - value
     41				     ;	      ES:DI - absolute address of string
     42				     ; Exit:  ES:DI <- addr next to the	first occurence	of value
     43				     ;	      ZF <- 1 if value is found
     44				     ;		    0 if value is not found
     45				     ; Destr: CX
     46				     ;==========================================================================
     47
     48	0011			     strchr	     proc
     49
     50	0011  57				     push di
     51	0012  E8 FFEB				     call strlen
     52	0015  5F				     pop di
     53
     54	0016  E8 0000e				     call memchr
     55
     56	0019  C3				     ret
     57	001A					     endp
Turbo Assembler	 Version 4.1	    03/03/20 17:51:58	    Page 2
str_std.asm



     58
     59				     ;==========================================================================
     60				     ; Compares	two null-terminated strings
     61				     ; Entry: ES:DI - absolute addr of the str1
     62				     ;	      DS:SI - absolute addr of the str2
     63				     ; Exit:  ZF <- 0 if str1 != str2
     64				     ;		    1 if str1  = str2
     65				     ;	      CF <- 0 if str1  > str2
     66				     ;		    1 if str1  < str2
     67				     ; Destr: DI SI
     68				     ;==========================================================================
     69
     70	001A			     strcmp	     proc
     71
     72	001A  26: 8A 2D		     @@loop:	     mov     ch, byte ptr es:[di]
     73	001D  8A 0C				     mov     cl, byte ptr ds:[si]
     74	001F  02 CD				     add     cl, ch
     75	0021  80 F9 00				     cmp     cl, 0
     76	0024  74 03				     je	     @@end
     77
     78	0026  A6				     cmpsb
     79	0027  74 F1				     jz	     @@loop
     80
     81
     82						     ;push di
     83						     ;call strlen
     84						     ;pop di
     85
     86						     ;inc cx
     87						     ;call memcmp
     88
     89	0029  C3		     @@end:	     ret
     90	002A					     endp
     91
     92				     ;==========================================================================
     93				     ; Copies null-terminated string to	the destination
     94				     ; Entry: ES:DI - destination absolute address
     95				     ;	      DS:SI - source absolute address
     96				     ; Destr: CX DI SI
     97				     ;==========================================================================
     98
     99	002A			     strcpy	     proc
    100
    101	002A  57				     push di
    102	002B  E8 FFD2				     call strlen
    103	002E  5F				     pop di
    104
    105	002F  E8 0000e				     call memcpy
    106
    107	0032  C3				     ret
    108	0033					     endp
    109
    110				     ;==========================================================================
    111
    112				     end
Turbo Assembler	 Version 4.1	    03/03/20 17:51:58	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "03/03/20"
??FILENAME			  Text	 "str_std "
??TIME				  Text	 "17:51:58"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@END				  Near	 DGROUP:0029
@@LOOP				  Near	 DGROUP:001A
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 STR_STD
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
MEMCHR				  Near	 DGROUP:---- Extern
MEMCMP				  Near	 DGROUP:---- Extern
MEMCPY				  Near	 DGROUP:---- Extern
MEMSET				  Near	 DGROUP:---- Extern
STRCHR				  Near	 DGROUP:0011
STRCMP				  Near	 DGROUP:001A
STRCPY				  Near	 DGROUP:002A
STRLEN				  Near	 DGROUP:0000

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0033 Word	  Public  CODE
